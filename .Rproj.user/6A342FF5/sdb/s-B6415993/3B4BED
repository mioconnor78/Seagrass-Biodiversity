{
    "collab_server" : "",
    "contents" : "library(MuMIn)\nlibrary(plyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\n\n### Shoot data\nshoots2015 <- read.csv(\"./data/biodiversitysurvey.2015.eelgrass.quadrat.csv\")\ngrazers2015 <- read.csv(\"./data/biodiversitysurvey.2015.grazers.quadrat.csv\")\nView(shoots2015)\n\n### data processing\nHakai <- shoots2015 %>%\n  filter(Region == \"Hakai\") %>%\n  rename(density = X..of.shoots.in.quadrat) %>%\n  rename(Zdrywt = total.dry.weight) %>%\n  replace(is.na(.), 0) %>%\n  mutate(meZ = macroepiphyte / Zdrywt) %>%\n  mutate(microZ = microepiphyte / Zdrywt)\n\nView(Hakai)\n\n\nView(grazers2015)\ngrazers <- grazers2015 %>%\n  mutate(site_sample = paste(Site_short, Sample, sep = \".\")) %>%\n  group_by(site_sample) %>%\n  select(-(Site:size.class)) %>%\n  summarise_each(funs(sum)) %>%\n  mutate(total.grazers = rowSums(.[2:67])) %>%\n  separate(site_sample, c(\"Site_short\", \"sample.ID\"))\n\nView(grazers)\n\npooled <- inner_join(grazers, Hakai)\nView(pooled)\n\npooled <- pooled %>%\n  mutate(grazers.zmshoot = total.grazers / density) %>%\n  mutate(grazers.zmbio = total.grazers / Zdrywt)\n\n\n## FIGURES\nshoot.density <- ggplot(Hakai, aes(x = Site_short, y = density)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Zostera Shoots (N/0.0625 m^2)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\nshoot.density\nggsave(\"shoot.density2015.jpg\", plot = shoot.density, width = 7, height = 3)\n\n\nZm.biomass <- ggplot(Hakai, aes(x = Site_short, y = Zdrywt)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Zostera Dry Wt (g/0.0625 m^2)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\nZm.biomass\nggsave(\"Zm.biomass2015.jpg\", plot = Zm.biomass, width = 7, height = 3)\n\n\nMacro.epi.Z <- ggplot(Hakai, aes(x = Site_short, y = meZ)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Macro Epi / Zg (g/g)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\nMacro.epi.Z\nggsave(\"Macro.epi.Z2015.jpg\", plot = Macro.epi.Z, width = 7, height = 3)\n\n\nMicro.epi.Z <- ggplot(Hakai, aes(x = Site_short, y = log(microZ))) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Micro Epi / Zm (g/g)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\nMicro.epi.Z\nggsave(\"Micro.epi.Z2015.jpg\", plot = Micro.epi.Z, width = 7, height = 3)\n\n\nGrazer.density <- ggplot(pooled, aes(x = Site_short, y = total.grazers)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Grazers (N/0.0625 m^2)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\nGrazer.density\nggsave(\"Grazer.density2015.jpg\", plot = Grazer.density, width = 7, height = 3)\n\n\ngrazers.zmshoot <- ggplot(pooled, aes(x = Site_short, y = grazers.zmshoot)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Grazers/shoot (N/shoot)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\ngrazers.zmshoot\nggsave(\"grazers.zmshoot2015.jpg\", plot = grazers.zmshoot, width = 7, height = 3)\n\n\n\ngrazers.zmbio <- ggplot(pooled, aes(x = Site_short, y = grazers.zmbio)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Grazers/Zm biomass (N/g)\") +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) \n\ngrazers.zmbio\nggsave(\"grazers.zmbio2015.jpg\", plot = grazers.zmbio, width = 7, height = 3)\n\nView(Hakai)\n\n#Read in datafile\nseagrass=read.csv(\"./data/hakaigrazer.csv\")\nseagrass <- seagrass[,-(53:62)]\nseagrass$Abundance <- sum(seagrass[,5], seagrass[,6])\n\nclass(seagrass[,(3:50)])\ndim(seagrass)\n#identify working datafile\ndata<- seagrass\n\ndim(seagrass)\n\n## collapse size classes\ndata1 <- ddply(data, .(Site, Sample.number), summarize, sum(data[,(5:52)]))\n\n\n\nhist(log(data$Abundance))\n\nplot(log(data$Abundance) ~ data$average_sal, col = c(data$Time), pch = 19)\nplot(log(data$Abundance) ~ data$average_temp, col = c(data$Time), pch = 19)\nplot(log(data$Abundance) ~ data$dens, col = c(data$Time), pch = 19)\nplot(data$average_sal ~ data$average_temp, col = c(data$Time), pch = 19)\nplot(data$average_sal ~ data$Time)\nplot(data$average_temp ~ data$Time)\nplot(data$average_sal ~ data$Site)\nplot(data$average_temp ~ data$Site)\nplot(data$dens ~ data$Site, col = c(data$Time), pch = 19)\n\n## the plots of temperature and salinity suggest that salinity is a better site-level variable, and temperature varies more through time than among sites. if you want to say that in the talk, do stats and say we only have point sampling data (not continuous datalogger data)\n\n#### Modeling effects of different predictors of abundance\n# I chose these models each based on a hypothesis that was influenced by looking at each of the plots above\n# the AIC results in model.sel (below) suggest that mod4 is the best, telling us that abundance varies by site and that variation is explained in part by salinity, and time. we dind't retain a model with a time*temp interaction. this isn't incredibly conclusive, but I'd move forward with this conclusion: salinity explains some of the site differences in abundance. Temperature and other factors might too...\nmod0 <- lm(log(data$Abundance+0.1) ~ 1, data = data)\nmod1 <- lm(log(data$Abundance+0.1) ~ Site, data = data)\nmod2 <- lm(log(data$Abundance+0.1) ~ Site + Time, data = data)\nmod3 <- lm(log(data$Abundance+0.1) ~ Site*Time, data = data)\nmod4 <- lm(log(data$Abundance+0.1) ~ Site*average_sal + Time, data = data)\nmod5 <- lm(log(data$Abundance+0.1) ~ Site*average_sal + Time*average_temp, data = data)\nmod6 <- lm(log(data$Abundance+0.1) ~ Site*average_sal*Time, data = data) \n\nmodel.sel(mod0, mod1, mod2, mod3, mod4, mod5, mod6)\n\n##### Considering shoot density. \n##### if you had meadow area or something, you could add that here too\n##### we can't include shoot density in the above model set b/c we don't have shoot density for all those sites. \n\nsites.dens <- sg.time[-which(sg.time$dens == 'NA'),]\ndata <- sites.dens\n\nmod0.1 <- lm(log(data$Abundance+0.1) ~ 1, data = data)\nmod1.1 <- lm(log(data$Abundance+0.1) ~ Site, data = data)\nmod2.1 <- lm(log(data$Abundance+0.1) ~ Site + Time, data = data)\nmod3.1 <- lm(log(data$Abundance+0.1) ~ Site*Time, data = data)\nmod4.1 <- lm(log(data$Abundance+0.1) ~ Site*average_sal + Time, data = data)\nmod5 <- lm(log(data$Abundance+0.1) ~ Site*average_sal + Time*average_temp, data = data)\nmod6 <- lm(log(data$Abundance+0.1) ~ Site*average_sal*Time, data = data) \n",
    "created" : 1498830035388.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1128984996",
    "id" : "3B4BED",
    "lastKnownWriteTime" : 1498864696,
    "last_content_update" : 1498864696705,
    "path" : "~/Documents/projects/Biodiversity/Biodiversity BC/eelgrass biodiversity BC/HBI/Hakai grazers/analysis/HBI analysis.R",
    "project_path" : "analysis/HBI analysis.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}